{"ast":null,"code":"import { isomorphicUnfetchData } from '../utils/api';\nimport Router from \"next/router\";\nexport const handleSignOut = async e => {\n  e.preventDefault();\n  await isomorphicUnfetchData({\n    route: 'api/signout',\n    method: 'POST',\n    body: {\n      name: 123\n    }\n  });\n  Router.push('/');\n};\nexport const handleSignIn = async e => {\n  e.preventDefault();\n  await isomorphicUnfetchData({\n    route: 'api/signin',\n    method: 'POST',\n    body: {\n      name: 123\n    }\n  });\n};\nexport const redirectOnAuthError = res => {\n  if (false) {\n    Router.push(\"/account/signin\");\n    return {};\n  } else {\n    res.writeHead(302, {\n      Location: '/account/signin'\n    });\n    res.end();\n    return {};\n  }\n};\nexport const checkAuthReturnData = async ({\n  api_res,\n  res\n}) => {\n  if (api_res.ok) {\n    const json = await api_res.json(); //get and save user info on redux\n\n    return json;\n  } else {\n    // https://github.com/developit/unfetch#caveats\n    return redirectOnAuthError(res);\n  }\n};","map":{"version":3,"sources":["/Users/jiasheng/Documents/GitHub/tbj/src/services/auth.js"],"names":["isomorphicUnfetchData","Router","handleSignOut","e","preventDefault","route","method","body","name","push","handleSignIn","redirectOnAuthError","res","writeHead","Location","end","checkAuthReturnData","api_res","ok","json"],"mappings":"AAAA,SAASA,qBAAT,QAAsC,cAAtC;AAEA,OAAOC,MAAP,MAAmB,aAAnB;AAEA,OAAO,MAAMC,aAAa,GAAG,MAAMC,CAAN,IAAW;AACtCA,EAAAA,CAAC,CAACC,cAAF;AACA,QAAMJ,qBAAqB,CAAC;AAAEK,IAAAA,KAAK,EAAE,aAAT;AAAwBC,IAAAA,MAAM,EAAE,MAAhC;AAAwCC,IAAAA,IAAI,EAAE;AAAEC,MAAAA,IAAI,EAAE;AAAR;AAA9C,GAAD,CAA3B;AACAP,EAAAA,MAAM,CAACQ,IAAP,CAAY,GAAZ;AACD,CAJM;AAMP,OAAO,MAAMC,YAAY,GAAG,MAAMP,CAAN,IAAW;AACrCA,EAAAA,CAAC,CAACC,cAAF;AACA,QAAMJ,qBAAqB,CAAC;AAAEK,IAAAA,KAAK,EAAE,YAAT;AAAuBC,IAAAA,MAAM,EAAE,MAA/B;AAAuCC,IAAAA,IAAI,EAAE;AAAEC,MAAAA,IAAI,EAAE;AAAR;AAA7C,GAAD,CAA3B;AACD,CAHM;AAKP,OAAO,MAAMG,mBAAmB,GAAIC,GAAD,IAAS;AAC1C,aAAmC;AACjCX,IAAAA,MAAM,CAACQ,IAAP,CAAY,iBAAZ;AACA,WAAO,EAAP;AACD,GAHD,MAGO;AACLG,IAAAA,GAAG,CAACC,SAAJ,CAAc,GAAd,EAAmB;AAAEC,MAAAA,QAAQ,EAAE;AAAZ,KAAnB;AACAF,IAAAA,GAAG,CAACG,GAAJ;AACA,WAAO,EAAP;AACD;AACF,CATM;AAWP,OAAO,MAAMC,mBAAmB,GAAG,OAAO;AAACC,EAAAA,OAAD;AAAUL,EAAAA;AAAV,CAAP,KAA0B;AAC3D,MAAIK,OAAO,CAACC,EAAZ,EAAgB;AACd,UAAMC,IAAI,GAAG,MAAMF,OAAO,CAACE,IAAR,EAAnB,CADc,CAEd;;AACA,WAAOA,IAAP;AACD,GAJD,MAIO;AACL;AACA,WAAOR,mBAAmB,CAACC,GAAD,CAA1B;AACD;AACF,CATM","sourcesContent":["import { isomorphicUnfetchData } from '../utils/api';\n\nimport Router from \"next/router\";\n\nexport const handleSignOut = async e => {\n  e.preventDefault();\n  await isomorphicUnfetchData({ route: 'api/signout', method: 'POST', body: { name: 123 }});\n  Router.push('/');\n};\n\nexport const handleSignIn = async e => {\n  e.preventDefault();\n  await isomorphicUnfetchData({ route: 'api/signin', method: 'POST', body: { name: 123 }});\n};\n\nexport const redirectOnAuthError = (res) => {\n  if (typeof window !== \"undefined\") {\n    Router.push(\"/account/signin\");\n    return {}\n  } else {\n    res.writeHead(302, { Location: '/account/signin' })\n    res.end();\n    return {}\n  }\n};\n\nexport const checkAuthReturnData = async ({api_res, res}) => {\n  if (api_res.ok) {\n    const json = await api_res.json();\n    //get and save user info on redux\n    return json;\n  } else {\n    // https://github.com/developit/unfetch#caveats\n    return redirectOnAuthError(res);\n  }\n}\n"]},"metadata":{},"sourceType":"module"}